<Window x:Class="LibrarySystem.LibrarianIssue"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Issue Book"
        WindowStyle="None"
        ResizeMode="NoResize"
        WindowState="Maximized"
        Background="#121212"
        Loaded="Window_Loaded">

    <Grid>
        <Grid.Resources>
            <SolidColorBrush x:Key="PrimaryBrush" Color="#20B2AA"/>
            <SolidColorBrush x:Key="DarkBrush" Color="#008B8B"/>
            <SolidColorBrush x:Key="LightBrush" Color="#00CED1"/>
            <SolidColorBrush x:Key="WhiteText" Color="White"/>
            <SolidColorBrush x:Key="LabelText" Color="#AAAAAA"/>

            <Style x:Key="NavButton" TargetType="Button">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="Foreground" Value="White"/>
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="Padding" Value="12,8"/>
                <Setter Property="Cursor" Value="Hand"/>
                <Setter Property="Effect">
                    <Setter.Value>
                        <DropShadowEffect Color="#20B2AA" BlurRadius="5"/>
                    </Setter.Value>
                </Setter>
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Foreground" Value="{StaticResource LightBrush}"/>
                    </Trigger>
                </Style.Triggers>
            </Style>

            <Style x:Key="CardStyle" TargetType="Border">
                <Setter Property="Background" Value="#1E1E1E"/>
                <Setter Property="CornerRadius" Value="5"/>
                <Setter Property="BorderBrush" Value="#333333"/>
                <Setter Property="Padding" Value="15"/>
            </Style>

            <Style x:Key="InputField" TargetType="TextBox">
                <Setter Property="Background" Value="#252525"/>
                <Setter Property="Foreground" Value="White"/>
                <Setter Property="BorderBrush" Value="#20B2AA"/>
                <Setter Property="Padding" Value="8"/>
                <Setter Property="FontSize" Value="14"/>
            </Style>

            <Style x:Key="DatePickerStyle" TargetType="DatePicker">
                <Setter Property="Background" Value="#252525"/>
                <Setter Property="Foreground" Value="White"/>
                <Setter Property="BorderBrush" Value="#20B2AA"/>
                <Setter Property="Padding" Value="8"/>
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="DatePicker">
                            <Grid>
                                <DatePickerTextBox x:Name="PART_TextBox"
                                                   Background="#252525"
                                                   Foreground="White"
                                                   BorderBrush="#20B2AA"
                                                   Padding="8"
                                                   FontSize="14"/>
                                <Popup x:Name="PART_Popup"
                                       Placement="Bottom"
                                       AllowsTransparency="True"
                                       IsOpen="{Binding IsDropDownOpen, RelativeSource={RelativeSource TemplatedParent}}"
                                       Focusable="False"
                                       PopupAnimation="Slide">
                                    <Border Background="#252525"
                                            BorderBrush="#20B2AA"
                                            BorderThickness="1">
                                        <Calendar x:Name="PART_Calendar"
                                                  Background="#252525"
                                                  Foreground="White"
                                                  BorderBrush="#20B2AA"/>
                                    </Border>
                                </Popup>
                            </Grid>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </Grid.Resources>

        <!-- Navigation Bar -->
        <StackPanel Background="#121212" VerticalAlignment="Top">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <TextBlock Text="Library Management System"
                           FontSize="20"
                           FontWeight="Bold"
                           Margin="10,5"
                           Foreground="White"/>

                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button Content="Dashboard" Style="{StaticResource NavButton}" Click="Dashboard_Click" Background="LightSeaGreen"/>
                    <Button Content="Book Status" Style="{StaticResource NavButton}" Click="BookStatus_Click" Background="LightSeaGreen"/>
                    <Button Content="Issue/Reserve" Style="{StaticResource NavButton}" Click="IssueReserve_Click" Background="LightSeaGreen"/>
                    <Button Content="Member Records" Style="{StaticResource NavButton}" Click="MemberRecords_Click" Background="LightSeaGreen"/>
                    <Button Content="Fine Collection" Style="{StaticResource NavButton}" Click="FineCollectionClick" Background="LightSeaGreen"/>
                    <Button Content="Account" Style="{StaticResource NavButton}" Click="Account_Click" Background="LightSeaGreen"/>
                </StackPanel>
            </Grid>
        </StackPanel>

        <!-- Main Content -->
        <Grid Margin="20,80,20,20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="10"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Student Panel -->
            <Border Style="{StaticResource CardStyle}">
                <StackPanel>
                    <TextBlock Text="STUDENT" FontSize="16" Foreground="{StaticResource PrimaryBrush}" Margin="0,0,0,10"/>
                    <DataGrid x:Name="dgStudents" AutoGenerateColumns="False" Height="150" SelectionChanged="dgStudents_SelectionChanged">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="UserID" Binding="{Binding UserId}" Width="100"/>
                            <DataGridTextColumn Header="First Name" Binding="{Binding FirstName}" Width="*"/>
                            <DataGridTextColumn Header="Last Name" Binding="{Binding LastName}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <TextBlock Text="SELECTED STUDENT:" FontWeight="Bold" Margin="0,10,0,5"/>
                    <TextBlock x:Name="txtSelectedStudent" Foreground="White"/>
                    <TextBlock Text="User ID:" Foreground="{StaticResource LabelText}" Margin="0,5,0,0"/>
                    <TextBox x:Name="txtstudentuserId" Style="{StaticResource InputField}" IsReadOnly="True"/>
                    <TextBlock Text="First Name:" Foreground="{StaticResource LabelText}" Margin="0,5,0,0"/>
                    <TextBox x:Name="txtStudentfirstname" Style="{StaticResource InputField}" IsReadOnly="True"/>
                    <TextBlock Text="Last Name:" Foreground="{StaticResource LabelText}" Margin="0,5,0,0"/>
                    <TextBox x:Name="txtStudentlastname" Style="{StaticResource InputField}" IsReadOnly="True"/>

                    <!-- New: Issued Books -->
                    <TextBlock Text="BOOKS ISSUED TO STUDENT:" FontWeight="Bold" Margin="0,20,0,5" Foreground="{StaticResource PrimaryBrush}"/>
                    <DataGrid x:Name="dgIssuedBooks" AutoGenerateColumns="False" Height="120" IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Issue ID" Binding="{Binding IssueId}" Width="100"/>
                            <DataGridTextColumn Header="Book Title" Binding="{Binding BookTitle}" Width="*"/>
                            <DataGridTextColumn Header="Issue Date" Binding="{Binding IssueDate}" Width="120"/>
                            <DataGridTextColumn Header="Due Date" Binding="{Binding DueDate}" Width="120"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </StackPanel>
            </Border>

            <Border Grid.Column="1"/>
            <!-- spacer -->

            <!-- Book Panel -->
            <Border Style="{StaticResource CardStyle}" Grid.Column="2">
                <StackPanel>
                    <TextBlock Text="BOOK" FontSize="16" Foreground="{StaticResource PrimaryBrush}" Margin="0,0,0,10"/>
                    <DataGrid x:Name="dgBooks" AutoGenerateColumns="False" Height="200" SelectionChanged="dgBooks_SelectionChanged">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="BookID" Binding="{Binding BookId}" Width="100"/>
                            <DataGridTextColumn Header="Title" Binding="{Binding Title}" Width="*"/>
                            <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <TextBlock Text="SELECTED BOOK:" FontWeight="Bold" Margin="0,10,0,5"/>
                    <TextBox x:Name="txtSelectedBook" Style="{StaticResource InputField}" IsReadOnly="True"/>
                    <TextBox x:Name="txtBookAuthor" Style="{StaticResource InputField}" IsReadOnly="True" Margin="0,5,0,0"/>
                    <TextBox x:Name="txtBookStatus" Style="{StaticResource InputField}" IsReadOnly="True" Margin="0,5,0,0"/>
                </StackPanel>
            </Border>

            <!-- Issue Button & DatePicker -->
            <StackPanel Orientation="Vertical" HorizontalAlignment="Center" Margin="0,413,0,58" Grid.Column="2">
                <TextBlock Text="Due Date:" Foreground="{StaticResource LabelText}" Margin="0,5,0,0"/>
                <DatePicker x:Name="dpDueDate"
                            Style="{StaticResource DatePickerStyle}"
                            SelectedDateFormat="Short"/>
                <Button Content="ISSUE BOOK"
                        Background="{StaticResource PrimaryBrush}"
                        Foreground="White"
                        FontWeight="Bold"
                        Padding="15,5"
                        Width="200"
                        Click="IssueBook_Click"/>
            </StackPanel>
        </Grid>
    </Grid>
</Window>
